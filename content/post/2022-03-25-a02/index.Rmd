---
title: A02
author: R package build
date: '2022-03-25'
slug: a02
categories: []
tags: []
---

```{r}
library(tidyverse)
library(boot)
library(patchwork)
df <- read.csv(file = 'https://raw.githubusercontent.com/ellaprotz/webstie_ella/master/Professor_Proposes_Data_Final.csv')
```

```{r}
summary(df)
```

## Frequiencies of each variable 
```{r}
df %>% count(Cut)
cut <- df %>%
  ggplot() +
  geom_bar(aes(Cut, fill = Cut)) +
  theme(
    axis.title.x = element_blank(),
    legend.position = "none"
  )

df %>% count(Clarity)
clarity <- df %>%
  ggplot() +
  geom_bar(aes(Clarity, fill = Clarity)) +
  theme(
    axis.title.x = element_blank(),
    legend.position = "none"
  )

df %>% count(Certification)
certification <- df %>%
  ggplot() +
  geom_bar(aes(Certification, fill = Certification)) +
  theme(
    axis.title.x = element_blank(),
    legend.position = "none"
  )

df %>% count(Polish)
polish <- df %>%
  ggplot() +
  geom_bar(aes(Polish, fill = Polish)) +
  theme(
    axis.title.x = element_blank(),
    legend.position = "none"
  )

df %>% count(Symmetry)
symmetry <- df %>%
  ggplot() +
  geom_bar(aes(Symmetry, fill = Symmetry)) +
  theme(
    axis.title.x = element_blank(),
    legend.position = "none"
  )
cut + clarity + certification + polish + symmetry
```

## Comparison of Variables with Price, Boxplots
```{r}
carat <- ggplot(data = df, 
       mapping = aes(x = Carat, y = Price,
                     colour = Wholesaler)) +
  geom_point() 
color <- ggplot (df, aes(x = Colour, y = Price)) +
  geom_boxplot()
cut <- ggplot (df, aes(x = Cut, y = Price)) +
  geom_boxplot()
clarity <- ggplot (df, aes(x = Clarity, y = Price)) +
  geom_boxplot()
certification <- ggplot (df, aes(x = Certification, y = Price)) +
  geom_boxplot()
polish <- ggplot (df, aes(x = Polish, y = Price)) +
  geom_boxplot()
symmetry <- ggplot (df, aes(x = Symmetry, y = Price)) +
  geom_boxplot()
 carat + cut + color + clarity + certification + polish + symmetry 
```
### Bases on the graphs, it shows that the Carat and color has the most impact on price. As Carat increases, the price increases. It also shows that for colors J, K, L all have a higher price, which falls within the Faint yellow and light yellow. D has the highest price which is completely colorless and G which is Near colorless also has very high price. By looking at the chart, and those two factors, the diamond will come out to be around $2500, by just looking. The other boxplots have variation in them, showing that there isn't much correlation between them and price. For example, despite the polish going from Fair to Excelet, the price does not increase as the Polish quality increases, so therefor it shows that that variable does not have much impact on the price. On average, based on all of the factors that go into pricing, we can estimate the price will fall under $3000, so it is under the Professors price. 

## Effect of Variables on the Carat
```{r}
cut <- ggplot (df, aes(x = Cut, y = Carat)) +
  geom_boxplot()
color <- ggplot (df, aes(x = Colour, y = Carat)) +
  geom_boxplot()
clarity <- ggplot (df, aes(x = Clarity, y = Carat)) +
  geom_boxplot()
certification <- ggplot (df, aes(x = Certification, y = Carat)) +
  geom_boxplot()
polish <- ggplot (df, aes(x = Polish, y = Carat)) +
  geom_boxplot()
symmetry <- ggplot (df, aes(x = Symmetry, y = Carat)) +
  geom_boxplot()
cut +  color + clarity + certification + polish + symmetry 
```
### Basesd on the graphs, it shows that there are no variables that impact the Carat of the diamond, which is the main impact on price. 

## Linear Regression Model
```{r}
model <- lm(Price~Carat, data = df)
summary(model)
```
## Therefore the equation of Price based on  just Carats is y = -200.48 + 2864.73x. The R-squared value is .8564, indicating it is a pretty decent model of fit for Linear Regression. It is not the strongest, but it is still pretty good.

```{r}
plot(model)
```

## Regression model for all variables
```{r}
model <- lm(Price~Carat + Colour + Clarity + Polish + Symmetry + Certification, data = df)
summary(model)
```
## The equation for Price based on Carat and all the factors is y = -1419.008 + 4203.8547x. The R-Squared value is .9736, indicating this linear model is a very good fit. 

```{r}
plot(model)
```


## Bootstrap Validation
```{r}
set.seed(1)
head(df)
dim(df)
train <- sample(440, 220)
head(train)
```

```{r}
boot.fn <- function(data, index) {
  return(coef(lm(Price~Carat, data = df, subset = index)))
}
```

```{r}
boot.fn(Auto, 1:440)
```

```{r}
set.seed(1)
boot.fn(df, sample(440, 440, replace = T))
```

```{r}
boot(df, boot.fn, 100)
```

```{r}
boot.out <- boot(df, boot.fn, 100)
plot(boot.out)
```

```{r}
boot.fn <- function(data, index) {
  return(coef(lm(Price~Carat, data = df, subset = index)))
}
boot.fn(df, 1:440)
boot(df, boot.fn, 1000)
boot.out <- boot(df, boot.fn, 1000)
plot(boot.out)
```


## The final price we can predict the diamond to be based on will be:
1. Just Carots is 2377.78
2. Everything : 2,364.46

Based on the two numbers, it will fall under the Professors budget and that the factors like color, clarity, cut etc do not have much impact on the pricing of the diamond. 